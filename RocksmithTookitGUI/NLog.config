<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="nlog" type="NLog.Config.ConfigSectionHandler, NLog"/>
  </configSections>
  <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        autoReload="true" throwExceptions="false" internalLogFile="nLog_selflog.txt" internalLogLevel="Error">
    
		<variable name="dlayout" value = "${longdate} | ${machinename} | PID: ${processid} | ${logger} (${level:uppercase=true}) : ${newline} ${callsite} ${newline} ${message} ${newline}${exception:format=ToString}" />
    <variable name="brief" value = "${longdate} | ${level} | ${logger} | ${message}"/>
    <variable name="verbose" value = "${longdate} | ${machinename} | ${processid} | ${processname} | ${level} | ${logger} | ${message}"/>
    <variable name="MachineID" value="${processinfo:property=MachineName} - ${windows-identity:userName=true:domain=false}" />
    
		<targets async="true">
			<target xsi:type="File"
				name="logFile"
				keepFileOpen="true"
				fileName="_RSToolkit_${shortdate}.log"
				layout="${dlayout}"
				lineEnding="Default"
        archiveEvery="Month"
				archiveFileName="_RSTLogDB_${shortdate}.txt"
				archiveAboveSize="1024000"
				archiveNumbering="Sequence"
				autoFlush="true"
        concurrentWrites="true"
        deleteOldFileOnStartup="true"
        maxArchiveFiles="15"
				/>
      <target xsi:type="EventLog"
				 name="event"
				 layout="${message}"
				 source="MyProgram"
				 eventId="555"
				 log="Application"
				 />
			<target xsi:type="Mail"
				name="ToGmailMail"
				header="LogFile From ${MachineID}"
				layout="${dlayout}"
				html="true"
				addNewLines="true"
				encoding="UTF-8"
				subject="Bug-Report for RSToolkit"
				to="RSToolkit@gmail.com"
				from="${MachineID}"
				body="${dlayout} || ${message}"
				enableSsl="true"
				smtpUserName="${MachineID}@rstoolkit.logger"
				smtpPassword="password"
				smtpAuthentication="Basic"
				smtpServer="smtp.gmail.com"
				smtpPort="587"
				/>
<!--			<target xsi:type="Database" name="database">
			<connectionString>
				data source=LABPC02;initial catalog=SampleDatabase;Integrated Security=SSPI;
				</connectionString>
				<commandText>
				INSERT INTO Diagnostics
				(Severity
				,Message
				,StackTrace
				,User
				,MachineName
				)
				VALUES (  @severity
				, @message
				, @stacktrace
				, @User
				, @machinename
				)				
				</commandText>
				<parameter name="@severity" layout="${level}"/>
				<parameter name="@message" layout="${message}"/>
				<parameter name="@machinename" layout="${machinename}"/>
				<parameter name="@User" layout="${windows-identity:domain=true}"/>
				<parameter name="@stacktrace" layout="${stacktrace}"/>
			</target> -->
		</targets>
		<rules>
			<logger name="*" minLevel="Error" writeTo="event" />
			<logger name="*" minLevel="Info" writeTo="logFile"/>
		</rules>
  </nlog>
<!--
  <nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <variable name="logDirectory" value="${basedir}\..\..\logs\web"/>
        <variable name="applicationName" value="MyCompany MyApplication Web"/>
        <include file="${basedir:dir=bin}\NLog-Standard.config" />
</nlog> 

and in config file
<targets>
        <target name="f1" xsi:type="File" fileName="${logDirectory}/${shortdate}.txt" keepFileOpen="true" layout="${exception:format=type,message,stacktrace}"/>
        <target name="eventLog" xsi:type="EventLog" log="Application" source="${applicationName}"
                layout="General Information${newline}${newline}MachineName: ${machinename}${newline}TimeStamp: ${longdate}${newline}AppDomainName: ${appdomainname}${newline}ThreadCulture: ${CurrentThread:variable=CurrentCulture}${newline}ThreadUICulture: ${CurrentThread:variable=CurrentUICulture}${newline}WindowsIdentity: ${windows-identity}${newline}LogMessage: ${message}${newline}Exception Information:${exception:format=type,message,method,stacktrace}"  />
</targets>
<rules>
        <logger name="*" writeTo="f1" />
        <logger name="*" minlevel="Error" writeTo="eventLog" />
</rules>
-->
</configuration>